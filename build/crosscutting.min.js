/*
 crosscutting. AOP JavaScript Library
 author: javarouka@gmail.com
 document: http://javarouka.github.io/crosscutting.js
 license: MIT
 create date: 2014-01-22
*/
!function(a){"use strict";function b(b){var c=!1,d=i;"undefined"==typeof ender&&(a.crosscutting=b?function(){return!c&&console&&console.warn&&(c=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),d.apply(null,arguments)}:i)}var c=[].slice,d={}.hasOwnProperty,e={}.toString,f=new Error("argument is invalid"),g=new TypeError("cannot apply aop on Built-in Type"),h=new Error("advice function is invalid. It should be function type");Array.prototype.forEach=Array.prototype.forEach||function(a,b){var c,f;if(null==this)throw new TypeError("this is null or not defined");var g=Object(this),h=g.length>>>0;if("[object Function]"!==e.call(a))throw new TypeError(a+" is not a function");for(b&&(c=b),f=0;h>f;){var i;d.call(g,f)&&(i=g[f],a.call(c,i,f,g)),f++}};for(var i={},j=["Function","Number","String","Date","RegExp","Boolean"],k=function(a){i["is"+a]=function(b){return e.call(b)==="[object "+a+"]"}},l=0,m=j.length;m>l;l++)k(j[l]);i.isArray=Array.isArray||function(a){return"[object Array]"===e.call(a)},i.isObject=function(a){return a===Object(a)};var n=[Function.prototype,Number.prototype,String.prototype,Date.prototype,Boolean.prototype,Object.prototype,Date.prototype,Array.prototype],o=function(a){return c.call(a)};i.argumentsToArray=o;var p={BEFORE:function(a){var b=a.advice.call(a.target,a),c=a.todo.apply(a.target,o(a.args));return b||c},AFTER:function(a){var b=a.todo.apply(a.target,o(a.args)),c=a.advice.call(a.target,a);return c||b},AROUND:function(a){return a.advice.call(a.target,function(){return a.todo.apply(a.target,o(arguments[0]?arguments:a.args))},a)},EXCEPTION:function(a){try{return a.todo.apply(a.target,o(a.args))}catch(b){return a.exception=b,a.advice.call(a.target,a)}}},q=function(a){this.matcher=a};q.prototype.isMatch=function(a){if(i.isBoolean(this.matcher))return this.matcher;if(i.isRegExp(this.matcher))return this.matcher.test(a);if(i.isFunction(this.matcher))return this.matcher(a);throw f};var r=function(a){return a.$crosscutting={wrap:!0},a},s=function(a,b,c,d,e){var f=function(){return c({args:arguments,target:a,todo:b,advice:d,type:c,method:e})};return f.name=e,f},t=function(a,b,c,d){return i.isArray(a)||(a=[a]),a.forEach(function(a){n.forEach(function(b){if(b===a)throw g}),i.isString(c)&&(c=p[c.toUpperCase()]);var e;for(var f in a)if(e=f,i.isString(e)){var h=a[e];i.isFunction(h)&&b.isMatch(e)&&(a[e]=s(a,h,c,d,e))}}),this};i.Aspect={Pointcut:q,Advice:r,weave:t,AdviceType:p},i.before=function(a,b,c){return i.weave(a,b,p.BEFORE,c),this},i.after=function(a,b,c){return i.weave(a,b,p.AFTER,c),this},i.around=function(a,b,c){return i.weave(a,b,p.AROUND,c),this},i.exception=function(a,b,c){return i.weave(a,b,p.EXCEPTION,c),this},t(i.Aspect,new q(/^weave$/),i.Aspect.AdviceType.BEFORE,function(a){if(!a.args||a.args.length<3)throw f;if(!i.isObject(a.args[0]))throw f;if(!i.isFunction(a.advice))throw h;a.advice.$crosscutting||(a.advice=new r(a.advice)),a.args[1]instanceof q||(a.args[1]=new q(a.args[1]))}),i.weave=i.Aspect.weave,Object.freeze&&Object.freeze(i);var u="undefined"!=typeof module&&module.exports;u?(module.exports=i,b(!0)):"function"==typeof define&&define.amd?define("moment",function(a,c,d){return d.config().noGlobal!==!0&&b(void 0===d.config().noGlobal),moment}):b()}(this);