<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/additional.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="javascripts/highlight.js/styles/tomorrow-night-bright.css">
    <title>Raop.js by javarouka</title>
</head>

<body>
<a href="https://github.com/javarouka/raop.js">
    <img style="position: absolute; top: 0; left: 0; border: 0;"
         src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png"
         alt="Fork me on GitHub">
</a>
<div id="container">
    <div class="inner">

        <header>
            <h1>Raop.js</h1>
            <p>RAOP는 오브젝트 기반의 AOP 를 제공하는 간단한 자바스크립트 라이브러리입니다.</p>
        </header>

        <section id="downloads" class="clearfix">
            <a href="https://github.com/javarouka/raop.js/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
            <a href="https://github.com/javarouka/raop.js/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
            <a href="https://github.com/javarouka/raop.js" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <article id="main_content">
            <section>
                <h1>
                    <a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>
                    설치
                </h1>
                <ul>
                    <li>
                        <h2>nodejs</h2>
                        <pre><code class="bash">$ npm install raop</code></pre>
                    </li>
                    <li>
                        <h2>browser</h2>
                        <pre><code class="xml">&lt;script type="text/javascript" src="/path/to/raop.min.js"&gt;&lt;/script&gt;</code></pre>
                    </li>
                </ul>
            </section>
            <section>
                <h1>
                    <a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>
                    사용법
                </h1>
                <h2>Basic</h2>
                <h3>raop.weave 메서드</h3>
                <p>
                    객체(Object)와 관심(Aspect)을 특정 대상과 시점에 묶는 메서드입니다. 인자를 4개 받습니다.
                </p>
                <pre><code class="javascript">raop.weave([aopTarget], [pointcut], [adviceType], [advice])</code></pre>

                <ul>
                    <li>
                        <h4>aopTarget</h4>
                        <p>aop를 적용할 객체입니다. 빌트인 (Built-In) 타입의 프로토타입은 AOP를 적용할 수 없으며 적용하려고 하면 TypeError 가 던져집니다.</p>
                        <h5>적용 불가능한 객체들</h5>
                        <ul class="caution">
                            <li>String.prototype</li>
                            <li>Number.prototype</li>
                            <li>Boolean.prototype</li>
                            <li>Date.prototype</li>
                            <li>Array.prototype</li>
                            <li>Date.prototype</li>
                            <li>RegExp.prototype</li>
                            <li>Function.prototype</li>
                        </ul>
                    </li>
                    <li>
                        <h4>pointcut</h4>
                        <p>
                            aopTarget 에 적용될 메서드를 구별해내는 인자입니다.<br/>
                            <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank">정규표현식</a>이나 함수가 될 수 있습니다.
                            함수를 사용한다면 인자를 받는데, 다음과 같습니다. 포인트컷 함수는 반드시 boolean 값을 반환해야 합니다.
                        </p>
                        <pre><code class="javascript">fnPointcut([Method Name])</code></pre>

                        <dl class="arguments-desc">
                            <dt>Method Name</dt>
                            <dd>객체의 메서드 이름입니다. 이것으로 AOP 적용 여부를 판단하는 함수 몸체를 만들면 됩니다.</dd>
                        </dl>
                    </li>
                    <li>
                        <h4>adviceType</h4>
                        <p>어드바이스 타이밍입니다. 4종류가 있습니다(raop.Aspect.(BEFORE|AFTER|EXCEPTION|AROUND))</p>
                        <dl class="arguments-desc">
                            <dt>raop.Aspect.BEFORE</dt>
                            <dd>객체의 메소드가 실행되기 전 어드바이스가 실행됩니다.</dd>
                            <dt>raop.Aspect.AFTER</dt>
                            <dd>객체의 메소드가 실행된 뒤 어드바이스가 실행됩니다.</dd>
                            <dt>raop.Aspect.EXCEPTION</dt>
                            <dd>객체의 메소드가 무언가를 throw 하게 되면 실행됩니다.
                                당신은 어드바이스 함수에 전달되는 인자객체의 "exception" 속성을 사용하여 던져진 객체에 접근할 수 있습니다.</dd>
                            <dt>raop.Aspect.AROUND</dt>
                            <dd>객체의 메소드가 실행되지 않고 어드바이스가 실행됩니다.
                                대신 객체의 메소드는 어드바이스 함수의 첫번째 인자로 전달됩니다. 일반적인 인자 객체는 두번째 인자로 전달됩니다.</dd>
                        </dl>
                    </li>
                    <li>
                        <h4>advice</h4>
                        <p>
                            어드바이스 함수입니다.<br/>
                            어드바이스 함수는 일반적으로 인자 객체를 인자로 전달 받습니다.
                            다만 어드바이스 타이밍이 AROUND 일 경우 첫번째 인자로 객체 메소드가 오므로 인자 객체는 두번째 인자가 됩니다.<br/>
                            인자 객체의 속성은 다음과 같습니다.
                        </p>
                        <dl class="arguments-desc">
                            <dt>args</dt>
                            <dd>객체 메서드에 전달되는 Argument 객체입니다. 이 값을 조작하면 실제 객체 메서드의 인자도 바뀝니다. Arguments 객체에 대해서는
                                <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/arguments" target="_blank">MDN 문서</a>를 참고하세요
                                <pre><code class="javascript">// Simple arguments control Example
var obj = {
    // return argument received
    echo: function(value) { return value; }
};
raop.weave(
    obj,
    function() { return true; },
    raop.Aspect.AdviceType.BEFORE,
    function(options) {
        // change first arguments.
        options.args[0] = "yaho!";
    }
);
// same result. "yaho!".
console.log(obj.echo("ok?")); // "yaho!";
console.log(obj.echo("hello?")); // "yaho!";
</code></pre>
                            </dd>
                            <dt>target</dt>
                            <dd>AOP가 적용되는 객체입니다. 어드바이스는 이 객체를 컨텍스트(this)로 하여 실행됩니다.</dd>
                            <dt>todo</dt>
                            <dd>실제 수행될 메서드입니다</dd>
                            <dt>advice</dt>
                            <dd>weave 시 인자로 준 어드바이스 함수입니다.</dd>
                            <dt>type</dt>
                            <dd>weave 시 인자로 준 어드바이스 타이밍입니다.</dd>
                            <dt>method</dt>
                            <dd>pointcut에 의해 join 된 메서드의 이름입니다.</dd>
                            <dt>exception</dt>
                            <dd>
                                어드바이스 타입이 EXCEPTION이고 객체 메서드가 객체를 throw할 경우 객체 메서드에서 던져진 객체를 가지고 있습니다.
                            </dd>
                        </dl>
                    </li>
                </ul>
            </section>
            <section class="examples">
                <h2>Example Codes</h2>
                <h3 id="example0">예제에서 사용할 AOP를 적용할 객체입니다. 간단한 덧셈 뺄셈 프로그램입니다.</h3>
          <pre><code class="javascript">// Simple Calculator
var calculator = {
    plus: function(a, b) {
        return a + b;
    },
    minus: function(a, b) {
        return a - b;
    }
};</code></pre>
                <h4 id="example1">전달된 인자가 모두 숫자형인지 검사하는 AOP 적용(BEFORE 어드바이스) 예제</h4>
                <p>숫자형이 아닐 경우 TypeError를 Throw 하도록 했습니다.</p>
                <pre><code class="javascript">// Validator Advice
var argumentCheck = function(options) {
    var args = options.args;
    for(var i = 0, len = args.length; i < len; i++) {
        if(typeof args[i] !== 'number') {
            throw new TypeError("all arguments must be number type");
        }
    }
};

raop.weave(
    calculator,
    function() { return true; },
    raop.Aspect.AdviceType.BEFORE,
    argumentCheck
);

// maybe throw TypeError.
calculator.plus("one", "two");</code></pre>

                <h4 id="example2">객체의 메서드가 실행될 때 로그를 찍는 BEFORE 어드바이스 예제</h4>
                <p>메서드 실행 전 메서드의 이름과 함께 로그가 찍힐 것입니다.</p>
                <pre><code class="javascript">var logAdvice = function(options) {
    console.log("method " + options.method + " execute");
};

// plus method aop apply, type BEFORE
raop.weave(
    calculator,
    function(name) {
        return name === "plus";
    },
    raop.Aspect.AdviceType.BEFORE,
    logAdvice
);

// console.log("method plus execute")
var result = calculator.plus(1, 1);</code></pre>

                <h4 id="example3">EXCEPTION 어드바이스 예제</h4>
                <p>위에 나왔던 <a href="#example1">인자가 숫자인지 검증하는 AOP를 적용</a> 했다고 가정합니다. 이 예제에서는 일부러 오류를 내고 있습니다.</p>
                <pre><code class="javascript">var throwHandler = function(options) {
    var exception = options.exception;
    console.log("Error! " + exception.name + ". cause : " + exception.message);
    if(exception.stack) console.log(exception.stack);
};

// aop apply, type EXCEPTION
raop.weave(
    calculator,
    /^plus/,
    raop.Aspect.AdviceType.EXCEPTION,
    logAdvice
);

// string arguments
var result = calculator.plus("one", "two");
/*
Error: arguments must be number type
at Object.calculator.plus ( ... )
at ... some stacktrace ...
*/</code></pre>

            </section>

            <section class="contributer">
                <h1>
                    <a name="contributer" class="anchor" href="#contributer"><span class="octicon octicon-link"></span></a>
                    Contributer
                </h1>

                <div id="gravata">
                    <a href="http://ko.gravatar.com/javarouka" target="_blank">
                      <img src="http://2.gravatar.com/avatar/ea49d570a6a8654adf6c0b8d90e51290?size=160"
                           alt="javarouka profile image">
                    </a>
                </div>

                <ul>
                    <li>
                        <span>Mail: </span>
                        <a href="mailto:javarouka@gmail.com">javarouka@gmail.com</a>
                    </li>
                    <li>
                        <span>Github: </span>
                        <a href="https://github.com/javarouka"
                           target="_blank">https://github.com/javarouka</a>
                    </li>
                    <li>
                        <span>Facebook: </span>
                        <a href="https://www.facebook.com/hanghui.i"
                           target="_blank">https://www.facebook.com/hanghui.i</a>
                    </li>
                    <li>
                        <span>Twitter: </span>
                        <a href="https://twitter.com/YiHanghee" target="_blank">@YiHanghee</a>
                    </li>
                </ul>

            </section>
        </article>

        <footer>
            Raop.js is maintained by <a href="https://github.com/javarouka">javarouka</a><br>
            This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

    </div>
</div>
<script src="javascripts/highlight.js/highlight.pack.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>
</body>
</html>